# 《B站 投稿管理 列表》的视频 > 自动掐头去尾后 > 再上传发布到别的平台上

## 环境准备
* 
    * selenium: 自动化脚本是基于它实现调用浏览器功能的
    * msedgedriver.exe: Edge 无头浏览器引擎；该程序里通过 selenium 调用它来实现 web 自动化；第一次使用时，需求先查看自己系统的 Edge 版本号（打开浏览器>点击右上角的三个点"..."按钮>选择[ 帮助和反馈 ]>选择[ 关于 Microsoft Edge ] 查看浏览器版本号），然后根据版本号去下载版本号相同的 Edge 无头浏览器，下载完成后得到 .zip 包，解压后把其中的 msgdgedriver.exe 复制出来，放到 driver_exe/ 目录下即可
    * * Eage driver 下载地址：https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/
    * * Eage driver 指定版本直接下载地址（把中间的 96.0.1054.62 修改成想要下载的版本即可）：https://msedgedriver.azureedge.net/96.0.1054.62/edgedriver_win64.zip

## 功能说明
* 
    * 介于多个平台重复上传视频过于繁琐，便写了该脚本以便减轻劳作，我们可以通过执行相关功能，让脚本自动帮我们做这些事情

## 目录说明
* 
    * 【*】关键文件说明：之前脚本之前，一定要先获取自己的 cookie到这个 b_cookie.txt 文本里 -- 每个人都需要账号登录B站后，才能查询到自己的 《投稿管理》列表，这个文本中的内容就需要使用者自己去复制进去；
    * * [-] 获取 cookie 的方式是，在《投稿管理》列表页面，F12 打开浏览器的调式窗口，切换到 network 页签，选择 Fetch/XHR 只查看http请求，然后“稿件管理”列表切换一下查询 "已通过" 数据，会看到 network 里多出一条类似这样的请求地址：https://member.bilibili.com/x/web/archives?status=pubed&pn=1&ps=10&coop=1&interactive=1；点击这条请求信息，可以查看里面的“请求标头” > "Cookie" 的内容，把这 Cookie: 的值都复制到 该 b_cookie.txt 文本中
    ```shell
    # 《投稿管理》列表页面 链接案例
    https://member.bilibili.com/platform/upload-manager/article
    ```

    * 配置文件的相关说明
    ```shell
    |-- logs # 部分脚本输出的日志记录，便于调试时查看日志
    |-- request_video_all/request_remember.txt # 记录所有请求到的视频数据 -- 首次执行获取aid数据时会自动生成该文本
    |-- video_exclude/video_exclude.txt # 记录需要排除下载处理并上传的视频标题 -- 首次执行程序时会自动生成该文本，文本是空的，需要使用者自己去 request_remember.txt 里复制要排除的视频标题进去（注意不要自己写，因为碍于文件命名规则的原因，视频实际的标题是不能直接用作文件名的，程序里进行转换处理）
    |-- video_redeal_config/redeal_config.txt # 视频重新处理的配置文件 -- 视频下载后会生成该文件，若重新处理的操作(掐头去尾)有的视频有特殊性，就可以在这里配置针对性的参数，否则会统一使用 common_config.py 里的全局配置参数
    |-- video_upload_menu/xiaohongshu_menu.txt # 在下载视频、重新处理视频，或者这两步的联合操作之后，会生成该文本，里面记录着上传视频名单，上传视频时会根据该名单的顺序进行依次上传，如果自己有特殊的顺序要求，就可以先修改这里的顺序，随后再执行自动上传操作
    |-- upload_remember/ # 记录着已经在某平台上传的视频标题记录，已经上传过的视频不会重复上传（若存在标题名称相同的视频也不会重复上传，理论上不应该允许存在标题名称相同的视频）
    |-- common_config.py # 全局的配置参数都记录在该脚本中
    |-- personal_info.py # [敏感文件]存储一些必要的个人隐私数据，比如 手机号(用于登录) [该文件只会初始化生成后，使用者自行填写个人信息，且已被忽略，不会进行上传]
    |-- b_cookie.py # [敏感文件]存储用于B站访问接口的 cookie 数据 [该文件只会初始化生成后，使用者自行填写个人信息，且已被忽略，不会进行上传]
    |-- xhs_cookie.py # [敏感文件]存储用于小红书登录验证和访问接口的 cookie 数据 [该文件只会初始化生成后，使用者自行填写个人信息，且已被忽略，不会进行上传]
    ```

    * 视频文件的相关说明
    ```shell
    |-- driver_exe # 存放 selenium 自动化需要用到的“无头浏览器”引擎，该程序里用的是 Edge，虽然我在这里存放了一个案例文件，但是“无头浏览器”必须与自己电脑已安装的版本相同，否则 selenium 启动自动化脚本时会报错（版本不匹配），使用者此时需要从官网下载跟自己使用的 Edge 版本相同的"Edge无头浏览器 .exe 文件"
    |-- video_flv # 下载下来的原始视频文件 -- 由于 .flv 格式的视频文件不能被大多数播放器解析，所以只是保留在该目录里而已，后续会自动转为 .mp4 视频文件
    |-- video_mp4 # 下载下来的原始 .flv 视频文件都会被转换成 .mp4 文件（ffmpeg 实现）
    |-- video_tsfiles # 存放分解 video_mp4/ 目录下视频文件后的 .ts 切片视频文件，一个 .mp4 的视频文件名会对应这里一个文件夹，随后会通过筛选收集该目录下的 .ts 切片文件来重组成新的 .mp4 视频文件
    |-- video_new_mp4 # 重新处理（即 上面提到的筛选收集 .ts 切片文件再重组）后，得到的新的 .mp4 视频文件会存放到该目录下
    ```

## 一、《B站 投稿管理 列表》的视频 > 自动掐头去尾后 > 再上传发布到《小红书》平台上
* 
    * 使用说明：
    在整个工程的根目录下执行该指令
    ```shell
    py go_main_spider.py
    ```
    随后的提示选项里选择
    ```shell
    [] - 启动B站视频转移脚本(web端)：自动下载自己账号的<稿件管理>下的视频，并自动在其他平台上上传发布（目前仅支持<小红书>）
    ```
    然后根据提示选项，选择相应的操作即可（自认为提示已经很详细了）
    ```shell
    [*] - 选择你要的操作（默认项：[1]）：
    -----【标记[*]星号的是推荐操作】-----
    [0] - 视频标题转为视频文件名称
        |-- （这个选项用于测试 视频标题 转 文件名 的功能）
        |-- （由于文件存在命名规则，请求的视频标题需要进行处理后才能用于文件名）
    [1] - 请求<B站 我的稿件>列表数据，把视频标题输出到文本里，便于查看
    [2] - 下载<B站 我的稿件>列表的视频
    [3] - video_flv中的选择文件转MP4
    [4] - 下载并直接转MP4 -- 即 联合步骤 [2]->[3]
    [5] - 分解 video_mp4/ 目录下的视频为 .ts 切片文件
        |-- （通过 ffmpeg 分解成 .ts 切片文件）
    [6] - 重组 video_mp4/ 目录下的视频 -- 进行掐头去尾再重组成新的MP4文件
        |-- （掐头去尾后，重组成新的 .mp4 文件）
    [7] - 重新处理 video_mp4/ 目录下的视频：分解原始视频，掐头去尾后，再重组 -- 即联合步骤 [5]->[6]
    [8] - 生成一份针对《小红书 平台》的上传视频的配置文件    |-- （这部操作请一定要最起码保证需要上传的视频已经下载完成的前提下执行）
    [9] - [*]自动下载并生成新视频 -- 即 联合步骤：[4]->[7]
        |-- （备注：该过程结束后，会生成一份视频上传菜单，如果需要自定义上传顺序，请先更改该视频菜单后，再执行上传操作）
    [10] - [*]上传 video_mp4/ 目录下的所有视频到<小红书平台>
    [11] - B站视频搬运到<小红书平台> -- 即 联合步骤 [8]-[9]
        |-- （若只需要使用默认的上传顺序操作的，可直接用该项功能，若想要自定义上传顺序，请使用 [8] 和 [9]）
    ```